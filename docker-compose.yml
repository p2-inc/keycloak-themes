version: '3'

services:
  keycloak:
      image: quay.io/keycloak/keycloak:26.0.0
      environment:
        KEYCLOAK_ADMIN: admin
        KEYCLOAK_ADMIN_PASSWORD: admin
        KC_HTTP_RELATIVE_PATH: /auth
      ports:
        - 8080:8080
      volumes: 
        - ./target/keycloak-themes-0.32-SNAPSHOT.jar:/opt/keycloak/providers/keycloak-themes.jar
        - ./conf/cache-ispn-custom.xml:/opt/keycloak/conf/cache-ispn-custom.xml
      entrypoint: /opt/keycloak/bin/kc.sh --verbose start-dev --cache-config-file=cache-ispn-custom.xml --spi-email-template-provider=freemarker-plus-mustache --spi-email-template-freemarker-plus-mustache-enabled=true --spi-email-sender-provider=ext-email-override --spi-email-sender-ext-email-override-enabled=true --spi-email-sender-ext-email-override-host=smtp.someserver.com--spi-email-sender-ext-email-override-auth=true --spi-email-sender-ext-email-override-from=support@phasetwo.io --spi-email-sender-ext-email-override-port=587 --spi-email-sender-ext-email-override-starttls=true --spi-email-sender-ext-email-override-user=someuser --spi-email-sender-ext-email-override-password=somepass --spi-email-sender-ext-email-override-max-emails=200
